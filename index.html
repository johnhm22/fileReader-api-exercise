<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FileReader practice</title>
  </head>
  <script src="https://unpkg.com/prettier@2.6.2/standalone.js"></script>
  <script src="https://unpkg.com/prettier@2.6.2/parser-html.js"></script>
  <body>
    <input type="file" />

    <p>Preview</p>
    <div id="preview"></div>
  </body>
  <script>
    const fileInput = document.querySelector('input');
    const preview = document.getElementById('preview');

    fileInput.addEventListener('change', () => {
      const reader = new FileReader();
      reader.readAsDataURL(fileInput.files[0]);
      reader.addEventListener('load', () => {
        //create data url to represent image to be used for src of img tag
        const url = reader.result;
        const img = new Image();
        img.src = url;
        img.onload = () => {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = img.width;
          canvas.height = img.height;
          ctx.drawImage(img, 0, 0);
          preview.appendChild(canvas);

          //uploading image to external location
          canvas.toBlob((blob) => {
            const formData = new FormData();
            formData.append('img', blob, 'myImage.jpg');
            //send a POST fetch request to a defined url for example in cloudinary with
            //formData as the body
          });
        };
      });
    });
  </script>
</html>
